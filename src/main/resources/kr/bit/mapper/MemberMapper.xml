<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="kr.bit.mapper.MemberMapper">




    <select id="memberDoubleCheck" resultType="kr.bit.entity.Member">
        select *from member_table where memberID=#{memberID}
    </select>


<!-- auto 없애서 (select IFNULL(MAX(memberIdx)+1,1) from mem_table) 이거 사용-->
<!--   (select IFNULL(MAX(memberIdx)+1,1) from mem_table mem) 별칭을 안주면 중복테이블이라서 에러남 -->
    <insert id="register" parameterType="kr.bit.entity.Member">
        insert into mem_table(memberIdx, memberID, memberPw,memberName, memberAge, memberGender,
        memberEmail ,memberProfile)
        values((select IFNULL(MAX(memberIdx)+1,1) from mem_table mem)
               ,#{memberID}, #{memberPw}, #{memberName}, #{memberAge}, #{memberGender},
               #{memberEmail}, #{memberProfile})
    </insert>

    <select id="login" resultType="kr.bit.entity.Member" parameterType="kr.bit.entity.Member">
        select * from mem_table where memberID=#{memberID}
    </select>

    <update id="update" parameterType="kr.bit.entity.Member">
        update member_table set memberPw = #{memberPw}, memberName = #{memberName},
        memberAge = #{memberAge},memberGender = #{memberGender}, memberEmail=#{memberEmail}
        where memberID = #{memberID}
    </update>

<!--    프로필 업데이트-->
    <select id="getMember" resultType="kr.bit.entity.Member">
        select *from mem_table mem
        left outer join member_auth auth
        on
        mem.memberID=auth.memberID
        where mem.memberID=#{memberID}
    </select>

    <update id="memberProfile" parameterType="kr.bit.entity.Member">
        update member_table set memberProfile = #{memberProfile} where memberID = #{memberID}
    </update>

<!--    권한테이블 추가-->
    <insert id="authRegister" parameterType="kr.bit.entity.MemberAuth">
        INSERT INTO member_auth(memberID, auth) values(#{memberID}, #{auth})
    </insert>



</mapper>

